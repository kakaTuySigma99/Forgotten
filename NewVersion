local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
   Name = "Kaka Hub | Forgotten 2.3",
   LoadingTitle = "Kaka Hub",
   LoadingSubtitle = "by Kakatu",
   ShowText = "Rayfield",
   Theme = "Default",
   ToggleUIKeybind = "K",
   ConfigurationSaving = {Enabled = true, FolderName = "KakaHub", FileName = "Config"},
   Discord = {Enabled = false},
   KeySystem = false
})

local MainTab = Window:CreateTab("Main")

local Options = {"Do All Generators", "Generator UI"}
local selectedOption = Options[1]

MainTab:CreateDropdown({
    Name = "Select Action",
    Options = Options,
    CurrentOption = selectedOption,
    Callback = function(value)
        selectedOption = value
    end
})

MainTab:CreateButton({
    Name = "Execute",
    Callback = function()
        if selectedOption == "Do All Generators" then
            local Players = game:GetService("Players")
            local LocalPlayer = Players.LocalPlayer

            local function getCharacter()
                local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
                local hrp = char:WaitForChild("HumanoidRootPart")
                local humanoid = char:WaitForChild("Humanoid")
                return char, humanoid, hrp
            end

            local function teleportToCenter(part)
                local _, hrp = getCharacter()
                local centerPart = part:FindFirstChild("Positions") and part.Positions:FindFirstChild("Center")
                if centerPart then
                    hrp.CFrame = CFrame.new(centerPart.Position)
                else
                    hrp.CFrame = CFrame.new(part.Position)
                end
            end

            local function fireNearestPrompt(part)
                local _, hrp = getCharacter()
                for _, descendant in ipairs(part:GetDescendants()) do
                    if descendant:IsA("ProximityPrompt") then
                        pcall(function()
                            descendant:InputHoldBegin()
                            task.wait(0.5)
                            descendant:InputHoldEnd()
                        end)
                    end
                end
            end

            local function getAllGenerators()
                local gens = {}
                local success, map = pcall(function()
                    return workspace:WaitForChild("Map"):WaitForChild("Ingame"):WaitForChild("Map")
                end)
                if success then
                    for _, model in ipairs(map:GetDescendants()) do
                        if model:IsA("Model") and model.Name == "Generator" then
                            local part = model.PrimaryPart or model:FindFirstChildWhichIsA("BasePart")
                            local re = model:FindFirstChild("Remotes") and model.Remotes:FindFirstChild("RE")
                            if part and re then
                                table.insert(gens, {Part = part, Remote = re})
                            end
                        end
                    end
                end
                return gens
            end

            local generators = getAllGenerators()
            for _, gen in ipairs(generators) do
                teleportToCenter(gen.Part)
                task.wait(0.3)
                fireNearestPrompt(gen.Part)
                task.wait(0.2)
                for i = 1, 4 do
                    pcall(function() gen.Remote:FireServer() end)
                    task.wait(0.2)
                end
                task.wait(1)
            end

        elseif selectedOption == "Generator UI" then
            loadstring(game:HttpGet("https://pastebin.com/raw/BDT91tTw"))()
        end
    end
})
